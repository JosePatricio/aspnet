using System;using System.Collections.Generic;using System.Linq;using System.Text;using PersistenciaSigeor;using System.Transactions;using System.Diagnostics;using Negocio.Utilidades;namespace Negocio.GestionControl{    public class InspectorNegocio    {        public static string ObtenerInspectoresPorEstado(string estado)        {            List<SM_INSPECTOR> result = null;            try            {                var transactionOptions = new TransactionOptions { IsolationLevel = IsolationLevel.ReadUncommitted };                using (var transactionScope = new TransactionScope(TransactionScopeOption.Required, transactionOptions))                {                    using (var context = new SigeorEntities())                    {                        result = (from inspector in context.SM_INSPECTOR                                  where inspector.ESTADO == estado                                  orderby inspector.NOMBRES, inspector.APELLIDOS                                  select inspector).ToList();                    }                    transactionScope.Complete();                    if (result.Any())                    {                        result.ForEach(ent => ent.NOMBRECOMPLETO = ent.NOMBRES + " " + ent.APELLIDOS);                    }                }            }            catch (Exception ex)            {                Log.WriteEntry("No se pudo obtener el daño por estado: " + ex, EventLogEntryType.Error);                throw new Exception("No se pudo obtener el daño por estado: " + ex);            }            return result.Any() ? Serializador.SerializeEntity(result) : null;        }    }}
