using System;using System.Collections.Generic;using System.Linq;using System.Text;using PersistenciaSigeor;using System.Data.Objects;using Negocio.Utilidades;using System.Diagnostics;using System.Transactions;namespace Negocio.Seguridad{    public class Autorizacion    {        public int ValidacionAcceso(string usuario, string pagina)        {            int? result = 0;            try            {                var transactionOptions = new TransactionOptions                {                    IsolationLevel = System.Transactions.IsolationLevel.ReadUncommitted                };                using (var transactionScope = new TransactionScope(TransactionScopeOption.Required, transactionOptions))                using (var context = new SigeorEntities())                {                    result = context.SP_VALIDACION_ACCESO_PERFIL(usuario, pagina).SingleOrDefault();                }            }            catch (Exception ex)            {                Log.WriteEntry("No se pudo realizar la validacion de accesso para el usuario " + usuario + " :" + ex, EventLogEntryType.Error);                throw new Exception("No se pudo  realizar la validacion de accesso para el usuario " + usuario + " :" + ex);            }            return result ?? 0;        }    }}
